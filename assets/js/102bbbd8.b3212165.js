"use strict";(self.webpackChunkneo_4_jperf_guide=self.webpackChunkneo_4_jperf_guide||[]).push([[223],{3905:(e,n,r)=>{r.d(n,{Zo:()=>u,kt:()=>d});var t=r(7294);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function a(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?a(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=t.createContext({}),p=function(e){var n=t.useContext(c),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},u=function(e){var n=p(e.components);return t.createElement(c.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(r),d=o,f=m["".concat(c,".").concat(d)]||m[d]||l[d]||a;return r?t.createElement(f,i(i({ref:n},u),{},{components:r})):t.createElement(f,i({ref:n},u))}));function d(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=m;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=r[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}m.displayName="MDXCreateElement"},5079:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var t=r(7462),o=(r(7294),r(3905));const a={title:"Performance configuration",sidebar_label:"Performance configuration",slug:"/neo4j-performance-issue"},i=void 0,s={unversionedId:"performance-config",id:"performance-config",title:"Performance configuration",description:"Every database performance can depend on design, configuration, and the end hardware it runs on.",source:"@site/docs/performance-config.md",sourceDirName:".",slug:"/neo4j-performance-issue",permalink:"/neo4j-performance-issue",draft:!1,tags:[],version:"current",frontMatter:{title:"Performance configuration",sidebar_label:"Performance configuration",slug:"/neo4j-performance-issue"},sidebar:"neo4jperf_guide",previous:{title:"Out of memory exception",permalink:"/neo4j-out-of-memory"}},c={},p=[{value:"Neo4j performance issues",id:"neo4j-performance-issues",level:2},{value:"Tunning Neo4j performance issues",id:"tunning-neo4j-performance-issues",level:2},{value:"Understanding your Cypher query",id:"understanding-your-cypher-query",level:3},{value:"Understanding your graph schema",id:"understanding-your-graph-schema",level:3},{value:"Neo4j properties",id:"neo4j-properties",level:3}],u={toc:p};function l(e){let{components:n,...r}=e;return(0,o.kt)("wrapper",(0,t.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Every database performance can depend on design, configuration, and the end hardware it runs on.\nIf you ever run into the scaling bottleneck in your database, you know what I am talking about.\nNeo4j is a database written in Java, and it runs inside a JVM. From the start, you can assume that Neo4j won't be the most performant database on the market. "),(0,o.kt)("h2",{id:"neo4j-performance-issues"},"Neo4j performance issues"),(0,o.kt)("p",null,"In order to put things in perspective, take a look at this issue from Stack Overflow: ",(0,o.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/29303841/neo4j-performance-challenge-how-to-improve"},'"Neo4j Performance Challenge - How to Improve?"'),". As you can see from the issue, the user has 12.5 million nodes and 64 million relationships.\nThe scale of this graph is big. Of course, there are always bigger graphs, but this is sufficient to get a sense of scale. User describes issue in the right manner, taking in consideration ",(0,o.kt)("strong",{parentName:"p"},"graph schema"),", ",(0,o.kt)("strong",{parentName:"p"},"query profile"),", ",(0,o.kt)("strong",{parentName:"p"},"Neo4j properties"),", ",(0,o.kt)("strong",{parentName:"p"},"CPU"),", ",(0,o.kt)("strong",{parentName:"p"},"Memory"),", ",(0,o.kt)("strong",{parentName:"p"},"Disk")," and some less relevant things. By looking at all these variables, you can see a lot of complexity there. "),(0,o.kt)("h2",{id:"tunning-neo4j-performance-issues"},"Tunning Neo4j performance issues"),(0,o.kt)("p",null,"In order to help fight common performance issues, here are a few tips and tricks on how to improve Neo4j performance."),(0,o.kt)("h3",{id:"understanding-your-cypher-query"},"Understanding your Cypher query"),(0,o.kt)("p",null,"One of the common issues can come from not understanding your Cypher queries in detail. You can find where the performance issue is coming from by analyzing the query. Neo4j has a dedicated Cypher statement, ",(0,o.kt)("inlineCode",{parentName:"p"},"PROFILE"),", that you can use for Cypher optimizations. Take a look at this example: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"PROFILE\nMATCH (p)\nRETURN p\n")),(0,o.kt)("p",null,"As a result, you will get all details regarding the execution of this query, such as time, memory, DB hits, etc.\nFor more details, check out this ",(0,o.kt)("a",{parentName:"p",href:"https://neo4j.com/docs/cypher-manual/current/query-tuning/basic-example/"},"guide"),". "),(0,o.kt)("h3",{id:"understanding-your-graph-schema"},"Understanding your graph schema"),(0,o.kt)("p",null,"If you understand your graph schema and insights that can be extracted from the graph, you can see what the important nodes and relationships are. In order to boost database performance, you can use indexes and meaningful nodes/relationships to index them. This approach has pros and cons, but you can balance writing and reading speed. It is up to you to decide how to structure your graph. "),(0,o.kt)("h3",{id:"neo4j-properties"},"Neo4j properties"),(0,o.kt)("p",null,"You can use a whole set of configuration properties to improve Neo4j performance. Since Neo4j has some memory settings related to JVM, you can look at ",(0,o.kt)("a",{parentName:"p",href:"/neo4j-out-of-memory"},"memory guide"),". In the linked guide, you can find configurations that can help with performance.\nOne interesting configuration property is also related to memory but it's Neo4j specific. It is called ",(0,o.kt)("inlineCode",{parentName:"p"},"pagecache"),". Page cache defines the amount of memory cached in the RAM. The cache is used for important data such as indexes to avoid expensive disc access. You can set it up in neo4j.conf file like this: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dbms.memory.pagecache.size=16GB\n")),(0,o.kt)("p",null,"The page cache will improve write and read performance significantly. The downside here is that it is quite small for graph scale because of RAM limitations. The page cache will take 50% of available RAM if you do not configure it. "),(0,o.kt)("p",null,"For more details on performance tunning, take a look at Neo4j ",(0,o.kt)("a",{parentName:"p",href:"https://neo4j.com/developer/guide-performance-tuning/"},"guide")))}l.isMDXComponent=!0}}]);